<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content=""> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Appreciating Machine Learning Again - NeRF and Score Distillation | Jaidev Shriram</title> <meta name="author" content="Jaidev Shriram"> <meta name="description" content="Building a fresher, wider perspective on ML via recent work on 3D vision"> <meta name="keywords" content="jaidev, ucsd"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css?v=&lt;?=%20date('YmdHis')%20?&gt;" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.cs?v=&lt;?=%20date('YmdHis')%20?&gt;s" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons?v=&lt;?=%20date('YmdHis')%20?&gt;"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/icon.png"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://jaidevshriram.com/blog/2023/appreciating-machine-learning-again-nerf-and-score-distillation/"> </head> <body class=" sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm sticky-top px-md-5 mt-2"> <div class="container-fluid"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Jaidev </span>Shriram</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/assets/pdf/JaidevKariyatt_MLResume.pdf" target="_blank"> resumé </a> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Appreciating Machine Learning Again - NeRF and Score Distillation</h1> <p class="post-meta">December 31, 2023• Jaidev Shriram</p> <p class="post-tags"> <a href="/blog/2023"> <i class="fas fa-calendar fa-sm"></i> 2023 </a> </p> </header> <article class="post-content"> <p><br></p> <p>One of the biggest changes this year professionally was that I started appreciating machine learning again. Sometime during my undergrad, I remember getting annoyed at the field in general - the pace of it, how so much of it seemed random, and despite the amazing results many ML pipelines produced, I was less interested in the underlying logic. I learnt two things this year that changed my view (neural radiance fields and score distillation sampling), helping me better appreciate ML’s raw potential. More on the two things later.</p> <h2 id="ml-education-is-overly-structured">ML Education is overly structured</h2> <p><br></p> <p>The underlying issue I think is that I followed an overly structured view of ML - one that’s repeated a thousand times in almost identical phrasing across the internet - you have a dataset, and you want to fit a model on this dataset to predict some value or generate new similar data, and you want to avoid the awful overfitting problem with a bunch of tricks. You describe machine learning pipelines this way a thousand times, you start to think that this is all machine learning truly is:</p> <p><br></p> <ul> <li>you <strong>need</strong> a dataset</li> <li>you <strong>need</strong> to have a validation set</li> <li>you **need **to train in epochs</li> <li>… etc</li> </ul> <p><br></p> <p>I remember once a teaching assistant even said that when you think of images in ML, think of convolutional neural networks (CNNs). I probably repeated that when TAing myself. That’s a narrow view.</p> <p><br></p> <p>These are essential components in most ML pipelines for sure - but when motivated without any alternatives, they can be limiting. This is where the first thing I learnt this year comes in - neural radiance fields.</p> <p><br></p> <p><strong>The problem is:</strong> building a 3D model of objects / general environments from pictures captured on phones/cameras.</p> <p><br></p> <p>If asked how ML might factor into this before, I would’ve said something like - “build a massive 3D dataset, and train a model that accepts a set of images as input to predict the 3D model somehow”. That’s definitely a solid idea with many benefits but that’s still a conventional way of looking at ML and far from the only way of tackling it. That pipeline answers the question - <em>given a set of images, what does a 3D model look like? (There are non ML methods to answer this question too, but we’re focusing on ML here).</em> Is that the only question we can ask to solve our problem though? What I appreciate about the NeRF technique is that it tackles a different but equivalent question:</p> <p><br></p> <p>Q: <em>Given a (x, y, z) 3D coordinate, what is the colour of that point (or is it just empty)?</em></p> <p><br></p> <p>Naturally, if I ask this question a million times - for all 3D coordinates in some grid, I have all the information I need to build a 3D model somehow; if I ask you what the colour of all pixels in an image are, you can build the image back, similarly for 3D. There’s still the question of how I aggregate this information but there is a solution for that in computer graphics (volumetric rendering). Volume rendering simply aggregates 3D information along your line of sight to produce the actual colour that you see. For instance, when looking at an apple, you’ll see the red skin of the apple, but not the white interior of the apple (the red skin is closer to you than the white interior along that line of sight).</p> <p><br></p> <p><img src="https://prod-files-secure.s3.us-west-2.amazonaws.com/3122d440-75c1-4155-88d2-061d78141720/79fef375-0b91-4909-bddb-f2b4bf46094a/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&amp;X-Amz-Credential=AKIAT73L2G45HZZMZUHI%2F20240101%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20240101T180451Z&amp;X-Amz-Expires=3600&amp;X-Amz-Signature=a7df3c075f8fe7ad53d9d1d929b5fe5fd1e5c6aadd7ff1ecac534e9963286036&amp;X-Amz-SignedHeaders=host&amp;x-id=GetObject" alt=""></p> <p>Credit: Jon Barron</p> <p><br></p> <p>Now, to answer this question, we naturally need the supervision to be of a different form - since the question takes a 3D coordinate as input and produces a colour as output - we need supervision that has a mapping between the two. Turns out, we can do away with that 3D supervision and simply use the input images as supervision using volume rendering. I defer a deep explanation of this concept to other resources (such as <a href="https://dtransposed.github.io/blog/2022/08/06/NeRF/" rel="external nofollow noopener" target="_blank">https://dtransposed.github.io/blog/2022/08/06/NeRF/</a>) but effectively, training a NeRF involves:</p> <p><br></p> <ul> <li>Asking what the colour of (x, y, z) coordinates is across a grid</li> <li>Aggregating this information from the viewpoint of a camera (that we took our picture with) (volume rendering)</li> <li>Comparing how aligned this aggregate / render of the 3D model is with the picture taken (the actual supervision for our model)</li> </ul> <p><br></p> <p>As a result, the ML pipeline ends up looking quite different from the prototypical pipeline:</p> <p><br></p> <ol> <li>This pipeline has no real dataset of 3D models but you are still teaching a model to answer a question - so it is machine learning. Further, the fact that there is no dataset, makes it self-supervised in a way.</li> <li>The domain of the ML model is different from that of the input data. We were given pictures of a 3D scene but the ML model ended up taking 3D coordinates as input. This shows how reframing the problem can change the way we approach the problem entirely.</li> <li>There is no generalization in this model really. Since the question is just about 3D coordinates, most often it’s not practical to train a single model to determine every single 3D object (there’s also the question about what coordinate system you’d use). Effectively, the neural network used in NeRF ends up representing a single object.</li> <li>Many classic ML ideas don’t fit into this context - such as data augmentation (why would it help?). Other concepts such as overfitting and underfitting take on slightly different meanings here.</li> </ol> <p><br></p> <p>All this is to say that if I had to teach machine learning today - I would probably do it by motivating machine learning simply as the art of function approximation. The first step is identifying what function you want to approximate (this should be an actual exercise too!), and why in the first place - doing so would also let one understand ML in various domains beyond generative modelling (such as NeRF which uses physics-inspired ideas via rendering for machine learning). Without such motivation, I fear that ML would be synonymous with data-driven ML. Still, this pipeline has some resemblance to a conventional ML pipeline in that there is a loss function and we have some data to work with (the input images). We can break that assumption too.</p> <p><br></p> <h2 id="code-restricts-thinking">Code Restricts Thinking</h2> <p><br></p> <p>When learning about optimization in ML, you typically start by implementing the forward pass and the backwards pass manually - to get a sense of how gradients are computed to understand the role of autograd. However, after relying on Pytorch’s autograd for a long while - I internalized the idea that you needed to define a loss function that you had to differentiate to update your parameters - what if you could just skip the loss function and directly provide the gradient?</p> <p><br></p> <p>That’s what score distillation sampling from Dreamfusion (<a href="https://dreamfusion3d.github.io/" rel="external nofollow noopener" target="_blank">https://dreamfusion3d.github.io/</a>) and Score Jacobian Chaining (<a href="https://pals.ttic.edu/p/score-jacobian-chaining" rel="external nofollow noopener" target="_blank">https://pals.ttic.edu/p/score-jacobian-chaining</a>) comes in. The two papers tackle generating 3D objects from text prompts alone - describe a squirrel and obtain a 3D squirrel. Refer to the papers for an explanation on how they do this but for this discussion, note that theyuse diffusion models, which naturally predict the gradient of a distribution with respect to an input. This means that there is no real loss function to work with, just the gradient directly!</p> <p><br></p> <p>Further, you typically need a dataset in machine learning - but dreamfusion just uses another pretrained model in order to generate 3D objects!</p> <p><br></p> <p>There are also recent works that question whether the model you use for optimization needs to remain static throughout - what if you could manually tweak parts of it / remove parts / extend it and then continue your optimization? (Gaussian Splatting - <a href="https://repo-sam.inria.fr/fungraph/3d-gaussian-splatting/" rel="external nofollow noopener" target="_blank">https://repo-sam.inria.fr/fungraph/3d-gaussian-splatting/</a>) That’s also something that code tutorials don’t naturally encourage! When your perception of ML is directly tied to the conventions of a certain software framework, it’s too easy to just think that’s how things **have to **be. But the past year of research has simply shown me that many things are just principled choices - sometimes random. Understanding the fundamentals truly means envisioning the possibility of things not encouraged by these frameworks too! That’s pretty exciting.</p> <p><br></p> </article> </div> </div> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-151059628-1"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-151059628-1");</script> </body> </html>